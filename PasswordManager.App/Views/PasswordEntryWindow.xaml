<Window x:Class="PasswordManager.App.Views.PasswordEntryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding IsEditing, Converter={StaticResource BoolToTitleConverter}, FallbackValue='Add Password'}"
        Height="696" 
        Width="508"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="{Binding IsEditing, Converter={StaticResource BoolToTitleConverter}, FallbackValue='Add New Password'}"
                   FontSize="20"
                   FontWeight="Bold"
                   Margin="0,0,0,20"/>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" 
                     VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="0,0,0,20">
                <!-- Site Information -->
                <GroupBox Header="Site Information" Margin="0,0,0,10">
                    <StackPanel Margin="5">
                        <TextBlock Text="Site Name *" Margin="0,5,0,5"/>
                        <TextBox Text="{Binding SiteName, UpdateSourceTrigger=PropertyChanged}"
                                Padding="5"
                                Margin="0,0,0,10"/>

                        <TextBlock Text="Site URL" Margin="0,0,0,5"/>
                        <TextBox Text="{Binding SiteUrl, UpdateSourceTrigger=PropertyChanged}"
                                Padding="5"
                                Margin="0,0,0,5"/>
                    </StackPanel>
                </GroupBox>

                <!-- Credentials -->
                <GroupBox Header="Credentials" Margin="0,0,0,10">
                    <StackPanel Margin="5">
                        <!-- Username -->
                        <DockPanel Margin="0,5,0,10">
                            <TextBlock Text="Username *" DockPanel.Dock="Top" Margin="0,0,0,5"/>
                            <Button Content="Copy" 
                                    Command="{Binding CopyUsernameCommand}"
                                    DockPanel.Dock="Right"
                                    Margin="5,0,0,0"
                                    Width="60"/>
                            <TextBox Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"
                                     Padding="5"/>
                        </DockPanel>

                        <!-- Password -->
                        <TextBlock Text="Password *" Margin="0,0,0,5"/>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Password Input Row -->
                            <DockPanel Grid.Row="0">
                                <Button Content="Copy" 
                                        Command="{Binding CopyPasswordCommand}"
                                        DockPanel.Dock="Right"
                                        Width="60"
                                        Margin="5,0,0,0"/>
                                <Button Command="{Binding GeneratePasswordCommand}"
                                        Content="Generate"
                                        DockPanel.Dock="Right"
                                        Width="70"
                                        Margin="5,0,0,0"/>
                                <Button Command="{Binding TogglePasswordCommand}"
                                        Content="{Binding ShowPassword, Converter={StaticResource BoolToEyeConverter}}"
                                        DockPanel.Dock="Right"
                                        Width="60"
                                        Margin="5,0,0,0"/>
                                <TextBox Text="{Binding DisplayPassword, Mode=OneWay}"
                                         IsReadOnly="True"
                                         Padding="5"/>
                            </DockPanel>

                            <!-- Password Strength Indicator -->
                            <Border Grid.Row="1"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Margin="0,5,0,0"
                                    Padding="5">
                                <DockPanel>
                                    <TextBlock Text="Strength: " />
                                    <TextBlock Text="{Binding StrengthDescription}"
                                              Foreground="{Binding StrengthColor}"
                                              FontWeight="Bold"/>
                                </DockPanel>
                            </Border>
                        </Grid>

                        <!-- Expiration -->
                        <TextBlock Text="Password Expiration" Margin="0,10,0,5"/>
                        <DatePicker SelectedDate="{Binding ExpirationDate}"
                                  Padding="5"/>
                    </StackPanel>
                </GroupBox>

                <!-- Additional Information -->
                <GroupBox Header="Additional Information" Margin="0,0,0,5">
                    <StackPanel Margin="5">
                        <TextBlock Text="Notes" Margin="0,5,0,5"/>
                        <TextBox Text="{Binding Notes, UpdateSourceTrigger=PropertyChanged}"
                                AcceptsReturn="True"
                                TextWrapping="Wrap"
                                Height="60"
                                Padding="5"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <!-- Button Row -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Delete button (only visible in edit mode) -->
            <Button Grid.Column="0"
                    Content="Delete"
                    Command="{Binding DeleteCommand}"
                    Width="80"
                    Padding="5"
                    Background="#FFE6E6"
                    Visibility="{Binding IsEditing, Converter={StaticResource BooleanToVisibilityConverter}}"/>

            <!-- Cancel and Save buttons -->
            <StackPanel Grid.Column="2" Grid.ColumnSpan="2" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Right">
                <Button Content="Cancel"
                        Command="{Binding CancelCommand}"
                        Width="80"
                        Margin="0,0,10,0"
                        Padding="5"/>
                <Button Content="Save"
                        Command="{Binding SaveCommand}"
                        Width="80"
                        Padding="5"
                        Background="#E3F2FD"
                        IsDefault="True"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>